# Default values for rucio.
# This is a YAML-formatted file.
# Declare configuration parametersto be used when generating 
# OKD deployment YAML configs via Helm templates.

experiment: Uses $EXPERIMENT

# Number of pods to run for each daemon
abacusAccountCount: 1
abacusRseCount: 1
conveyorTransferSubmitterCount: 1
conveyorPollerCount: 1
conveyorFinisherCount: 1
hermesCount: 1
judgeCleanerCount: 1
judgeEvaluatorCount: 1
judgeInjectorCount: 1
judgeRepairerCount: 1
undertakerCount: 1
reaperCount: 1 
transmogrifierCount: 1
minosCount: 1
necromancerCount: 1

# Service Account
serviceAccountName: useroot

# Daemon Image
image:
  repository: bjwhitefnal/fnal-rucio-daemons
  tag: latest
  pullPolicy: Always

# Pod Upgrade Strategy
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 1

minReadySeconds: 5

# Daemons Specific Configuration Parameters
abacusAccount:
  threads: 1

abacusRse:
  threads: 1

conveyorTransferSubmitter:
  threads: 1
  activities: "'User Subscriptions' 'Recovery'"
  sleepTime: 10

conveyorPoller:
  threads: 1
  activities: "'User Subscriptions' 'Recovery'"

conveyorFinisher:
  threads: 1
  activities: "'User Subscriptions' 'Recovery'"

hermes:
  username: ____
  password: ____
  threads: 2 
  bulk: 100
  delay: 10
  port: 443
  use_ssl: True
  destination: /topic/rucio.events.int
  voname: int
  email_from: int Rucio <bjwhite@fnal.gov>
  email_test: bjwhite@fnal.gov

judgeCleaner:
  threads: 1

judgeEvaluator:
  threads: 1

judgeInjector:
  threads: 1

judgeRepairer:
  threads: 1

undertaker:
  threads: 1

reaper:
  scheme: "gsiftp"
  threads: 1

minos:
  threads: 1

necromancer:
  threads: 1

ftsRenewal:
  enabled: 1
  image:
    repository: bjwhitefnal/fnal-rucio-fts-cron
    tag: latest
    pullPolicy: Always
  vo: "fermilab"
  voms: "fermilab:/fermilab/Role=Production"
  servers: "https://fts3-dev.fnal.gov:8446"

## common config values used to configure the Rucio daemons
config:

  conveyor:
    max_time_in_queue: "User Subscriptions:5"
    ftshosts: "https://fts3-dev.fnal.gov:8446"
    cacert: "/etc/grid-security/ca.pem"
    usercert: "/opt/proxy/x509up"
    # scheme: "srm,gsiftp,root,http,https"
    # transfertool: "fts3"
    # cache_time: ""
    # user_deterministic_id: ""
    # poll_timeout: ""
    # submit_timeout: ""
    # bring_online: ""
    # queue_mode: ""
    # using_memcache: ""
    # ftsmonhosts: ""

  monitor:
    # Not sure if this will work here due to the secrets stuff in the RUCIO_CFG_ env var generation
    carbon_server: "lsdataitb.fnal.gov"
    carbon_port: "8225"
    user_scope: "rucio.int_okd"

optional_config:
  #rucio_cfg_database_echo: 1
  delegate_fts_proxy: "true"
  rucio_fts_voms: "fermilab:/fermilab/Role=Production"
