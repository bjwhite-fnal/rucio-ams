image:
  repository: imageregistry.fnal.gov/rucio-ams/rucio-ams-server

abacusAccountCount: 1
abacusRseCount: 1
conveyorTransferSubmitterCount: 1 
conveyorPollerCount: 1
conveyorFinisherCount: 1
conveyorStagerCount: 0
hermesCount: 1
judgeCleanerCount: 1
judgeEvaluatorCount: 1
judgeInjectorCount: 1
judgeRepairerCount: 1
tracerKronosCount: 1
transmogrifierCount: 1
undertakerCount: 1
reaperCount: 1
minosCount: 1
necromancerCount: 1
conveyorReceiverCount: 0

abacusRse:
  threads: 1 
  resources:
    limits:
      cpu: 700m
      memory: 4000Mi
    requests:
      cpu: 700m
      memory: 900Mi

reaper:
  greedy: 0
  threads: 1 
  sleepTime: 120
  resources:
    requests:
      memory: 750Mi
    limits:
      memory: 2Gi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorTransferSubmitter:
  activities: "'Recovery' 'User Subscriptions'"
    # Same size or smaller than bulk which is 100
  #groupBulk: 50
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorFinisher:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorPoller:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorReceiver:
  fullMode: 1
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

# Settings to renew FTS	proxy
ftsRenewal:
  enabled: 1
  image:
    repository: rucio/fts-cron
    tag: latest
  voms: "fermilab:/fermilab/Role=Production"
  servers: "https://fts-dev.fnal.gov:8446"

hermes:
  useSSL: 1
  threads: 1 
  bulk: 500
  brokerTimeout: 300
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
  resources:
    requests:
      memory: 400Mi
    limits:
      memory: 600Mi

judgeEvaluator: 
  resources:
    limits:
      cpu: 3750m 
    requests:
      cpu: 750m 
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeCleaner:
  threads: 2
  resources:
    limits:
      cpu: 3750m 
      memory: 4000Mi
    requests:
      cpu: 750m 
      memory: 400Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeInjector:
  threads: 2
  resources:
    limits:
      cpu: 3750m 
      memory: 8000Mi
    requests:
      cpu: 750m 
      memory: 400Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeRepairer:
  resources:
    limits:
      cpu: 3750m 
      memory: 4000Mi
    requests:
      cpu: 750m 
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

monitoring:
  enabled: true
  serviceMonitorEnabled: false

config:
  common:
    loglevel: "INFO"

  messaging_hermes:
    port: "61323"
    brokers: "msg-int-rucio.okd.fnal.gov"
    ssl_key_file: "/opt/rucio/keys/new_userkey.pem"
    ssl_cert_file: "/opt/rucio/certs/usercert.pem"
    destination: "/topic/rucio.events.int"
    voname: "fermilab"

  monitor:
    enable_metrics: "True"
    metrics_port: "8080"

  #tracer_kronos:
    #username: "cmsrucio"
    #port: "61313"
    #brokers: "msg-int-rucio.okd.fnal.gov"
    #queue: "/topic/rucio.events.int"
    ## FIXME: Both used to be 50 before 1.24 problems with Kronos
    #chunksize: "1"
    #prefetch_size: "10"

  messaging_fts3:
    username: "guest"
    port: "443"
    destination: "/topic/rucio.events.int"
    brokers: "msg-int-rucio.okd.fnal.gov"
    voname: "fermilab"
    use_ssl: "False"

transmogrifier:
  threads: 1
  bulk: 100
  resources:
    requests:
      memory: 200Mi
    limits:
      memory: 1450Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

tracerKronos:
  # FIXME: Was 5 before 1.24 problems with Kronos
  threads: 1
  resources:
    limits:
      cpu: 3000m 
      memory: 1Gi
    requests:
      cpu: 1000m 
      memory: 800Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

abacusAccount:
    resources:
      limits:
        cpu: 700m
        memory: 2000Mi
      requests:
        cpu: 700m
        memory: 250Mi

# Unused daemons which supply prometheus
automatix:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorThrottler:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

minos:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

necromancer:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

undertaker:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

